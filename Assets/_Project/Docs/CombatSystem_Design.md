# 전투 시스템 기획 문서

**게임 방식**: 순수 턴제 RPG 전투
**핵심**: 보드 매치 → 전투 효과 → 적 턴 → 반복

---

## 🎮 전투 흐름

### 기본 사이클
```
[전투 시작]
    ↓
[플레이어 턴]
  1. 보드에서 블록 연결
  2. 효과 즉시 발동 (공격/방어/회복 등)
  3. 턴 종료 버튼 (또는 자동)
    ↓
[적 턴]
  1. 예고된 행동 실행
  2. 플레이어 데미지 처리
  3. 다음 행동 예고
    ↓
[승패 판정]
  - 적 HP 0 → 승리
  - 플레이어 HP 0 → 패배
  - 아니면 플레이어 턴으로 복귀
```

### 턴 진행 예시
```
턴 1 - 플레이어:
  보드: 🔴⚔️ 5개 연결 → 공격 31
  적 HP: 50 → 19

턴 1 - 적:
  행동: 공격 8
  플레이어: 방어 0 → HP 100 → 92

턴 2 - 플레이어:
  보드: 🔵🛡️ 4개 연결 → 방어 22
  플레이어 방어: 0 → 22

턴 2 - 적:
  행동: 강공격 15 (예고됨)
  플레이어: 방어 22 → 0, HP 92 → 85
```

---

## 👤 플레이어 스탯

### 기본 스탯
```
HP (체력):
- 초기값: 100
- 최대값: 100 (유물로 증가 가능)
- 0 도달 → 게임 오버

방어력 (Defense):
- 초기값: 0
- 최대값: 30 (기본), 유물로 증가 가능
- 턴이 지나도 유지됨
- 적 공격 시 먼저 소모

골드 (Gold):
- 초기값: 0
- 상점에서 사용
- 전투 중 노란 블록으로 획득
```

### 방어력 시스템 상세
```
방어력의 역할:
- 적 공격 데미지를 먼저 흡수
- 방어력 > 적 공격 → HP 무손상
- 방어력 < 적 공격 → 남은 데미지만큼 HP 감소

예시 1:
  방어력 20, 적 공격 15
  → 방어력 20 - 15 = 5 (남음)
  → HP 손상 없음

예시 2:
  방어력 10, 적 공격 25
  → 방어력 10 - 25 = 0
  → HP 손상 15

예시 3:
  방어력 0, 적 공격 15
  → HP 손상 15
```

### 방어력 최대치
```
기본 최대: 30
유물로 증가 가능: +10, +15 등

이유:
- 무한 방어 방지
- 공격 vs 방어 밸런스 유지
- 전략적 선택 유도 (방어 쌓기 vs 공격)
```

---

## 👾 적 시스템

### 적 기본 구조
```
모든 적:
- HP (체력)
- 공격력
- 행동 패턴 리스트
- 다음 행동 예고
```

### 적 행동 종류
```
1. 공격 (Attack)
   - 기본 공격
   - 플레이어에게 데미지

2. 강공격 (Heavy Attack)
   - 높은 데미지
   - 1턴 전에 예고
   - 플레이어가 대비 가능

3. 방어 (Defend)
   - 적이 방어력 획득
   - 다음 공격 데미지 감소

4. 버프 (Buff)
   - 공격력 증가
   - 회피 등

5. 디버프 (Debuff)
   - 플레이어 방어력 감소
   - DOT 부여 등
```

### MVP 적 3종

#### 1. 슬라임 (초급)
```
HP: 30
공격력: 5

행동 패턴:
- 공격 (80%): 데미지 5
- 방어 (20%): 방어력 +3

특징:
- 가장 약한 적
- 패턴 단순
- 튜토리얼용
```

#### 2. 고블린 (중급)
```
HP: 50
공격력: 8

행동 패턴:
- 공격 (60%): 데미지 8
- 강공격 (40%): 데미지 12 (1턴 예고)
  → 예고: "고블린이 큰 칼을 휘두를 준비를 한다!"

특징:
- 강공격 대비 필요
- 방어 타이밍 중요
```

#### 3. 오크 보스 (보스)
```
HP: 150
공격력: 15

행동 패턴:
- 공격 (50%): 데미지 15
- 강공격 (30%): 데미지 25 (1턴 예고)
  → 예고: "오크가 분노하며 도끼를 들어올린다!"
- 방어 (20%): 방어력 +10

특수 능력:
- HP 50% 이하: 공격력 +5 (분노)
  → 공격 15 → 20
  → 강공격 25 → 30

특징:
- 긴 전투
- 후반 급상승하는 위협
- 방어/회복 밸런스 필요
```

---

## ⚔️ 데미지 계산

### 플레이어 → 적
```
기본 공식:
최종 데미지 = 블록 효과 합계 × 연쇄 보너스 × 유물 배율

예시:
검 블록 5개 (5+5+5+5+5 = 25)
× 1.25 (5개 연쇄 보너스)
× 1.2 (유물: 공격 +20%)
= 37 데미지
```

### 적 → 플레이어
```
1단계: 방어력 계산
  방어력 >= 적 공격력?
    YES → 방어력만 감소, HP 무손상
    NO → 다음 단계

2단계: HP 데미지
  실제 데미지 = 적 공격력 - 방어력
  HP 감소

예시 1:
  방어력 20, 적 공격 15
  → 방어력 5 남음, HP 그대로

예시 2:
  방어력 10, 적 공격 25
  → 방어력 0, HP -15
```

---

## 🎯 전략적 요소

### 의사결정 포인트

#### 1. 공격 vs 방어
```
상황: 적 HP 20, 다음 턴 강공격 25 예고

선택 A: 지금 공격 30 → 승리
선택 B: 방어 25 쌓기 → 다음 턴 안전

→ 공격으로 끝낼까? 안전하게 방어?
```

#### 2. 회복 타이밍
```
상황: 플레이어 HP 30, 방어력 0, 포션 블록 보임

선택 A: 포션 3개 연결 → HP +30 회복
선택 B: 공격 → 포션은 나중에

→ 지금 회복? 공격 우선?
```

#### 3. 방어 축적
```
상황: 적이 2턴 후 강공격 예정

선택 A: 2턴간 방어 누적 (최대 30)
선택 B: 공격해서 먼저 처치

→ 방어 쌓기? 선제 공격?
```

### 적 패턴 대응

#### 강공격 예고
```
턴 N:
  적: "강공격 준비 중..."
  플레이어: 방어를 쌓을 시간!

턴 N+1:
  적: 강공격 25 실행
  플레이어: 방어 30 → 무손상
```

#### 방어 중인 적
```
적이 방어 중:
  적 방어력 10

선택 A: 약한 공격 15 → 실제 5 데미지
선택 B: 강한 공격 30 → 실제 20 데미지

→ 방어 깨는 강공격이 유리
```

---

## 📊 밸런싱

### 전투 길이 목표
```
슬라임: 3-5턴
고블린: 5-8턴
오크 보스: 10-15턴

이유:
- 너무 짧으면 전략성 부족
- 너무 길면 지루함
- 턴당 15-30초 × 턴 수 = 전투 시간
```

### 데미지 밸런스
```
플레이어 평균 공격 (3개 연결):
- 검: 15
- 도끼: 24 (방어 -6)
- 화염: 9 + DOT 6

적 평균 공격:
- 슬라임: 5
- 고블린: 8-12
- 오크: 15-30

→ 플레이어가 공격적으로 유리
→ 하지만 방어 관리 필수
```

### HP 밸런스
```
플레이어 HP: 100
적 평균 데미지: 8-10/턴
방어 없이 버틸 수 있는 턴: 10-12턴

→ 10턴 안에 적을 처치하거나
→ 방어/회복으로 연장
```

### 방어력 밸런스
```
최대 방어력: 30
평균 적 공격: 10-15
방어력으로 막을 수 있는 공격: 2-3회

→ 방어 쌓기 = 2-3턴 안전
→ 무적이 아님 (최대치 제한)
→ 지속적 관리 필요
```

---

## 🎨 UI 요소

### 전투 화면 구성
```
┌─────────────────────────────────┐
│ 적 정보                          │
│ ┌─────────────────────────┐     │
│ │   [오크 그림]            │     │
│ │   HP: ████████░░ 80/150 │     │
│ │   방어: ██ 10            │     │
│ │   다음: "강공격!"         │     │
│ └─────────────────────────┘     │
├─────────────────────────────────┤
│ 보드 (8×8)                      │
│ [블록 매치 영역]                 │
│                                 │
│                                 │
├─────────────────────────────────┤
│ 플레이어 정보                     │
│ HP: ████████████ 85/100         │
│ 방어: ███████░░░ 22/30          │
│ 골드: 💰 15                     │
│                                 │
│ [턴 종료] 버튼                   │
└─────────────────────────────────┘
```

### 적 행동 예고
```
현재 턴:
  적 머리 위: 💭 "생각 중..."

다음 행동 결정:
  적 머리 위: ⚔️ "공격!"
  또는: 🛡️ "방어"
  또는: 💥 "강공격 준비!"

강공격 예고:
  적: 빨간 오라 + 애니메이션
  텍스트: "⚠️ 다음 턴 강공격!"
```

### 데미지 표시
```
플레이어 공격:
  적에게 숫자 팝업 (빨강)
  "-25"

적 공격:
  플레이어에게 숫자 팝업
  방어 소모: "-15" (파랑)
  HP 소모: "-8" (빨강)

회복:
  "+20" (초록)
```

---

## 🎁 상태 효과 시스템

### DOT (Damage Over Time)
```
화염 블록으로 부여:
  DOT 2 데미지, 3턴

적 턴마다:
  "적이 화상으로 2 데미지를 받는다"
  적 HP -2

활용:
  짧은 전투: 별 효과 없음
  긴 전투: 누적 데미지 큼
```

### 버프/디버프
```
버프 블록 (갈색):
  "다음 공격 +50%" (1턴)
  플레이어 공격 배율 1.5배

회피 블록 (푸른):
  "30% 확률로 회피" (2턴)
  적 공격 시 30% 확률로 무효

적 디버프:
  독: 턴마다 HP 감소
  약화: 공격력 감소
```

---

## 📦 MVP 범위

### Week 1
```
✅ 기본 턴제 시스템
✅ 플레이어 HP/방어력
✅ 적 1종 (슬라임)
✅ 기본 공격만
✅ 데미지 계산
✅ 승패 판정
```

### Week 2
```
✅ 적 3종 전체
✅ 적 행동 패턴
✅ 강공격 예고 시스템
✅ 방어력 시스템 완성
✅ 전투 UI
✅ 상태 효과 (DOT, 버프)
```

### Week 3 (선택)
```
🔶 더 다양한 적 패턴
🔶 특수 전투 (엘리트, 보스 연출)
🔶 전투 애니메이션 polish
🔶 사운드 & 이펙트
```

---

## 💡 디자인 의도

### 왜 순수 턴제?
```
vs 실시간:
✅ 전략적 깊이 (천천히 생각)
✅ 보드 최적화에 집중
✅ 로그라이크와 어울림
✅ 스트레스 적음

시간제한 없음:
✅ 초보자 친화적
✅ 복잡한 상황도 대응 가능
✅ 모바일에서도 편함
```

### 왜 방어력 누적?
```
vs 일회성 방어:
✅ 미리 준비 가능 (강공격 대비)
✅ 방어 중심 빌드 가능
✅ 전략적 선택 증가
✅ 긴장감 유지 (최대치 제한)
```

### 왜 행동 예고?
```
vs 랜덤 공격:
✅ 대응 가능 (전략적)
✅ 긴장감 조성
✅ 실력 반영 (운보다 실력)
✅ 공정함
```

---

## 🔮 향후 확장

### 더 다양한 적
```
- 다중 적 전투 (2-3마리)
- 특수 능력 (소환, 변신 등)
- 환경 효과 (독 안개, 불타는 바닥)
```

### 특수 전투
```
- 엘리트: 특별한 능력 + 높은 보상
- 이벤트 전투: 특수 조건
- 보스 러시
```

### 난이도 옵션
```
- Easy: 적 약화
- Normal: 기본
- Hard: 적 강화 + 시간제한
- Ascension: 점진적 난이도 증가
```

---

**작성일**: 2025-12-12
**버전**: 1.0
**담당**: 게임 디자인
