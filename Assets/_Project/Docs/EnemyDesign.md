# 적 디자인 문서 (Enemy Design)

**프로젝트**: MatchBattle
**버전**: 1.0
**작성일**: 2025-12-17
**관련 문서**:
- [CombatSystem_Design.md](CombatSystem_Design.md) - 전투 시스템
- [EnemyPatterns.md](EnemyPatterns.md) - 적 행동 패턴 데이터
- [StatusEffects.md](StatusEffects.md) - 상태 효과 데이터

---

## 📋 목차

1. [적 시스템 개요](#적-시스템-개요)
2. [행동 시스템](#행동-시스템)
3. [적 행동 패턴](#적-행동-패턴) → [EnemyPatterns.md](EnemyPatterns.md)
4. [특수 메커니즘](#특수-메커니즘)
5. [구현 우선순위](#구현-우선순위)

---

## 👾 적 시스템 개요

### 기본 구조

```
모든 적의 공통 요소:
├─ 스탯
│  ├─ HP (체력)
│  ├─ 공격력 (기본 공격 데미지)
│  └─ 방어력 (선택적)
│
├─ 행동 시스템
│  ├─ 행동 패턴 리스트
│  ├─ 행동 선택 확률
│  └─ 다음 행동 예고
│
└─ 특수 능력 (선택적)
   ├─ 조건부 발동
   └─ 페이즈 전환
```

### 적 분류

```
난이도별:
├─ 초급 (Tutorial): 슬라임
├─ 중급 (Normal): 고블린
└─ 보스 (Boss): 오크

역할별 (Post-MVP):
├─ 공격형: 높은 데미지, 낮은 HP
├─ 방어형: 낮은 데미지, 높은 HP + 방어
├─ 보조형: 버프/디버프 중심
└─ 특수형: 소환, 변신 등
```

---

## ⚔️ 행동 시스템

> **설계 철학**: 조합형 행동 시스템 (Slay the Spire 참고)

### 기본 행동 5가지

#### 1. 공격 (Attack)
```
개념:
- 플레이어에게 데미지
- 방어력 → HP 순서로 감소
- 수치만 다름 (약한 공격 ~ 강한 공격)

예시:
약한 공격: "슬라임이 몸을 부풀린다" → 5 데미지
중간 공격: "고블린이 칼을 휘두른다" → 8 데미지
강한 공격: "오크가 도끼를 내리친다" → 15 데미지

특징:
- 가장 기본적인 행동
- 수치로 위협도 표현
- 다른 행동과 조합 가능
```

#### 2. 방어 (Defend)
```
개념:
- 적이 방어력 획득
- 플레이어 공격 데미지 감소
- 전투 템포 조절

예시:
"고블린이 방패를 들어올린다" → 방어력 +10

메커니즘:
적 방어력 10 + 플레이어 공격 25 = 실제 데미지 15

전략적 의미:
- 약한 공격 비효율
- 강공격 모으기 유도
- 방어 중인 적 우선 처치 고려
```

#### 3. 버프 (Buff)
```
개념:
- 적 자신 강화
- 지속 효과 (N턴)
- 장기전 위협

종류:
- STR: 힘(±N) - 공격력 ±N (양수/음수, 영구)
- ARMOR: 철갑(N) - 피격 시 데미지 감소
- REGEN: 재생(N) - 턴마다 HP 회복, 1씩 감소

예시:
힘(5) → UI: 💪5
힘(-2) → UI: 💪-2
철갑(10) → UI: 🛡️10
재생(5) → UI: ✚5
```

> **상세 스펙**: [StatusEffects.md](StatusEffects.md) 참조

#### 4. 디버프 (Debuff)
```
개념:
- 플레이어 약화
- 지속 효과 (N턴)
- 빠른 처치 필요

종류:
- POISON: 독 N (턴마다 HP -N, 1씩 감소)
- WEAK: 약화, 공격력 -N%
- VULNERABLE: 취약, 받는 데미지 +N%

예시:
독 5 → UI: 💀5
약화 -30% (2턴) → UI: ↓2
```

> **상세 스펙**: [StatusEffects.md](StatusEffects.md) 참조

#### 5. 특수 (Special)
```
개념:
- 적 고유 행동
- 특별한 메커니즘
- 보스/엘리트에 주로 사용

종류:
- 소환: 졸개 추가
- 변신: 페이즈 전환
- 회복: HP 회복
- 특수 공격: 방어 무시, 관통 등

예시:
"오크 대장이 고블린을 소환한다!" → 고블린 2마리 추가
```

---

### 조합형 행동

#### 단일 행동
```
하나의 행동만 실행:

공격 (8)
→ 단순 데미지

방어 (+10)
→ 철갑만 획득

버프 (공격력 +3, 2턴)
→ 자신 강화
```

#### 조합 행동
```
두 가지 이상 행동 동시 실행:

공격 (8) + 디버프 (독(3))
→ 데미지 + 상태이상 부여

공격 (12) + 버프 (힘(5))
→ 공격하면서 자신 강화

방어 (+10) + 버프 (재생(5))
→ 방어 + 회복 효과

공격 (15) + 디버프 (취약 +50%, 2턴)
→ 공격 + 플레이어 약화
```

#### 조합 예시 (보스)
```
오크 보스의 다양한 조합:

1. 공격 (15)
   - 단순 공격

2. 공격 (20) + 버프 (힘(5))
   - 분노 페이즈 진입

3. 방어 (+10) + 버프 (재생(5))
   - 방어적 회복

4. 공격 (25) + 디버프 (약화 -30%, 2턴)
   - 강공격 + 플레이어 약화

5. 특수 (소환) + 버프 (힘(3))
   - 졸개 소환 + 자신 강화
```

### 행동 선택 시스템

```
기본 메커니즘:
1. 행동 패턴 리스트에서 가중치 기반 랜덤 선택
2. 다음 행동 예고 (플레이어에게 표시)
3. 다음 턴에 행동 실행

예시 (고블린):
행동 패턴:
- 공격 (60%): 데미지 8
- 강공격 (40%): 데미지 12 (1턴 예고)

실행 순서:
턴 1: 랜덤 선택 → 강공격 → "다음: 강공격!" 예고
턴 2: 강공격 실행 → 랜덤 선택 → "다음: 공격!" 예고
턴 3: 공격 실행 → ...
```

### 예고 시스템

```
UI 표시 - 단일 행동:
┌─────────────────────────┐
│   [고블린 그림]          │
│   HP: ████░░ 35/50      │
│                         │
│   다음 행동:            │
│   ⚔️ 공격 (8)           │
└─────────────────────────┘

UI 표시 - 조합 행동:
┌─────────────────────────┐
│   [고블린 그림]          │
│   HP: ████░░ 35/50      │
│                         │
│   다음 행동:            │
│   ⚔️💀 공격 (12)        │  ← 여러 아이콘으로 조합 표시
│      + 독(3)            │
└─────────────────────────┘

UI 표시 - 다중 조합:
┌─────────────────────────┐
│   [오크 보스 그림]       │
│   HP: ██████░░ 80/150   │
│                         │
│   다음 행동:            │
│   ⚔️💪 공격 (20)        │  ← 높은 수치 = 위협적
│      + 힘               │
└─────────────────────────┘

시각적 피드백:
- 공격: 붉은 빛 + ⚔️ 아이콘
  - 높은 데미지(15+): 빨간 오라 강조
- 방어: 파란 쉴드 + 🛡️ 아이콘
- 버프: 노란 빛 + ✨ 아이콘
- 디버프: 보라 기운 + 💀 아이콘
- 특수: 주황 효과 + ⭐ 아이콘

조합 표시:
- 아이콘 중첩으로 조합 표현
- 상세 정보는 텍스트로 추가
- 위험도에 따라 색상 변경

목적:
✅ 플레이어에게 정보 제공
✅ 전략적 대응 가능
✅ 공정한 난이도
✅ 긴장감 조성
✅ 복잡한 조합도 명확히 표시
```

---

## 🎯 적 행동 패턴

> **구체적인 적 패턴 데이터는 [EnemyPatterns.md](EnemyPatterns.md)를 참조하세요.**
>
> EnemyPatterns.md에 포함된 내용:
> - MVP 적 3종 (슬라임, 고블린, 오크) 상세
> - 밸런싱 가이드
> - 전략 가이드
> - Post-MVP 확장 적들
> - 엘리트 시스템
> - 보스 배리에이션

---

### 특수 메커니즘

#### 다중 적 전투 (최대 4체)

> **참고 게임**: Slay the Spire의 다중 적 전투 시스템

##### 기본 메커니즘

```
최대 적 수: 4체
화면 배치: 좌→우 정렬

┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 적 1    │ │ 적 2    │ │ 적 3    │ │ 적 4    │
│ HP:50   │ │ HP:30   │ │ HP:40   │ │ HP:25   │
│ 다음:공격│ │ 다음:버프│ │ 다음:공격│ │ 다음:방어│
└─────────┘ └─────────┘ └─────────┘ └─────────┘
```

##### 타겟팅 시스템

```
공격 블록 연결 시:
1. 블록 연결 완료
2. 타겟 선택 UI 표시
   ┌──────────────────────────┐
   │ 공격 25 데미지           │
   │ 대상을 선택하세요:       │
   │                          │
   │ [적1] [적2] [적3] [적4] │
   └──────────────────────────┘
3. 클릭한 적에게 데미지
4. 적 처치 시 자동으로 제거

방어/회복 블록:
- 타겟 선택 불필요
- 플레이어에게 자동 적용

특수 블록 (Post-MVP):
- AOE 블록: 모든 적에게 데미지
- 관통 블록: 2-3개체 관통
```

##### 적 턴 순서

```
적 행동 순서: 왼쪽 → 오른쪽

예시:
턴 시작:
├─ 적 1: 공격 8 → 플레이어
├─ 적 2: 버프 (자신 공격력 +3)
├─ 적 3: 공격 10 → 플레이어
└─ 적 4: 방어 (자신 방어력 +5)

총 데미지: 8 + 10 = 18
플레이어 방어: 20 → 2
```

##### 전투 예시

**예시 1: 고블린 무리 (3마리)**
```
구성:
├─ 고블린 전사 (HP 50, 공격 8)
├─ 고블린 궁수 (HP 30, 공격 6)
└─ 고블린 주술사 (HP 25, 버프/디버프)

전략 A: 주술사 우선 처치
→ 버프/디버프 차단
→ 안정적 전투

전략 B: 궁수 우선 처치
→ 빠른 숫자 감소
→ 적 행동 횟수 줄이기

전략 C: 전사 집중 공격
→ 가장 위협적인 적 제거
→ 시간 오래 걸림
```

**예시 2: 보스 + 졸개**
```
구성:
├─ 오크 대장 (HP 200, 공격 18) [보스]
├─ 고블린 (HP 50, 공격 8)
└─ 고블린 (HP 50, 공격 8)

페이즈 1:
- 졸개 먼저 처치 (안전)
- 보스 데미지 감수

페이즈 2 (보스만 남음):
- 1:1 전투
- 기존 보스전 전략 적용

대안 전략:
- 보스만 집중 공격
- 졸개 무시
- 빠른 승리, 높은 위험
```

**예시 3: 역할 분담 조합**
```
구성:
├─ 슬라임 탱커 (HP 80, 공격 3, 방어 높음)
├─ 고블린 딜러 (HP 40, 공격 12)
├─ 마법사 힐러 (HP 30, 적 회복 능력)
└─ 버서커 (HP 60, 공격 15, 광폭화)

최적 처치 순서:
1순위: 힐러 (회복 차단)
2순위: 딜러 (위협 제거)
3순위: 버서커 (시간 지연 방지)
4순위: 탱커 (마지막에 천천히)

실제 플레이:
턴 1-2: 힐러 집중 공격 → 처치
턴 3-4: 딜러 처치
턴 5-6: 버서커 처치
턴 7-10: 탱커 천천히 처치
```

##### 밸런싱 고려사항

```
적 수 증가 시:
- 개별 HP 감소 (총 HP는 증가)
- 보상 비례 증가
- 구체적 수치는 플레이 테스트로 결정

원칙:
✅ 다수의 약한 적 > 소수의 강한 적 (난이도)
✅ 처치 우선순위 전략이 핵심
✅ 보상으로 위험 보상
```

##### 전략적 깊이

```
의사결정 포인트:

1. 타겟 우선순위
   Q: 어떤 적을 먼저 처치?
   - 위협적인 적 (높은 공격력)
   - 보조 적 (버퍼, 힐러)
   - 약한 적 (빠른 숫자 감소)

2. 화력 분산 vs 집중
   Q: 한 적에 집중 vs 골고루 공격?
   - 집중: 빠른 처치, 적 행동 횟수 감소
   - 분산: AOE 효율, 전체 HP 관리

3. 긴급 상황 대응
   Q: 여러 적이 강공격 예고?
   - 방어 우선
   - 위협적인 적 처치
   - 회복 블록 찾기

4. 블록 선택
   Q: 지금 공격 vs 방어?
   - 적 4마리 → 방어 우선
   - 적 1마리 남음 → 공격 집중

5. AOE 활용 (Post-MVP)
   Q: AOE vs 단일 타겟?
   - 적 HP 고르게 낮음 → AOE
   - 한 적만 위협적 → 단일 집중
```

##### UI 설계

```
전투 화면 (4적):

┌─────────────────────────────────┐
│ 적 영역 (4개체 가로 배치)        │
│ ┌───┐  ┌───┐  ┌───┐  ┌───┐    │
│ │적1│  │적2│  │적3│  │적4│    │
│ │HP │  │HP │  │HP │  │HP │    │
│ │50 │  │30 │  │40 │  │25 │    │
│ │⚔️ │  │✨│  │⚔️ │  │🛡️ │    │
│ └───┘  └───┘  └───┘  └───┘    │
├─────────────────────────────────┤
│ 보드 (8×8)                      │
│ [블록 매치 영역]                 │
├─────────────────────────────────┤
│ 플레이어 정보                    │
│ HP: ████████████ 85/100         │
│ 방어: ███████░░░ 22/30          │
└─────────────────────────────────┘

타겟 선택 시:
- 선택 가능한 적 하이라이트 (빛나는 효과)
- 클릭 시 타겟 확정
- 데미지 예상치 표시
```

##### 구현 우선순위

```
MVP (현재):
✅ 단일 적 전투만

Post-MVP Phase 1:
🔶 2적 전투 구현
🔶 기본 타겟팅 시스템
🔶 간단한 조합 (고블린 × 2)

Post-MVP Phase 2:
🔶 3-4적 전투
🔶 역할 기반 조합 설계
🔶 보스 + 졸개 패턴

Post-MVP Phase 3:
🔶 AOE 블록 시스템
🔶 복잡한 시너지 조합
🔶 특수 메커니즘 (소환 등)
```

##### 슬레이 더 스파이어에서 배울 점

```
✅ 적 배치 시각화 (명확한 정보)
✅ 타겟팅 직관성 (클릭만으로 선택)
✅ 적 역할 분담 (전략적 깊이)
✅ 처치 우선순위 학습 곡선
✅ 시각적 피드백 (하이라이트, 화살표)

MatchBattle만의 차별점:
🎯 보드 매치 + 타겟팅 결합
🎯 블록 종류에 따른 타겟 선택
🎯 경로 연결의 전략성 유지
🎯 방어력 누적 시스템과의 조화
```

#### 소환 메커니즘
```
개념:
- 보스가 졸개 소환
- 졸개 먼저 처치 필요

예시:
턴 3 (보스):
"오크 대장이 고블린을 소환한다!"
→ 고블린 2마리 추가

플레이어 선택:
A. 졸개 먼저 처치 (안전)
B. 보스 계속 공격 (빠름, 위험)

밸런싱:
- 소환 쿨다운 (5턴마다)
- 최대 졸개 수 제한 (3마리)
```

---

### 난이도 옵션 (장기 계획)

```
1. Normal (기본)
   - 현재 밸런싱
   - 평균 승률 70%

2. Hard
   - 적 HP +30%
   - 적 공격력 +20%
   - 보상 +50%

3. Ascension (무한 난이도)
   - 클리어할 때마다 난이도 +1
   - Ascension 1: 적 HP +10%, 공격 +5%
   - Ascension 2: 적 HP +20%, 공격 +10%
   - ...
   - Ascension 20: 적 HP +200%, 공격 +100%

   추가 효과:
   - 적 행동 속도 증가
   - 엘리트 출현 빈도 증가
   - 보스 능력 강화
```

---

## 🎬 연출 가이드

> 게임 메커니즘과 별개로, 프레젠테이션 레이어에서 구현할 연출 가이드라인

### 보스 강화 패턴 연출

```
적용 대상:
- 보스급 적의 특수 메커니즘 발동 시
- 버프 획득 (특히 STR, ARMOR 등)
- 페이즈 전환 (HP 임계값 도달)

연출 요소 (선택적):
1. 시각 효과
   - 전신 오라 (색상: 버프 종류에 따라)
   - 빛나는 효과
   - 화면 진동 (미묘하게)

2. 애니메이션
   - 강화 포즈
   - 기본 공격 모션 변화
   - 이동 속도 변화

3. UI 강조
   - 버프 아이콘 강조 (크기, 색상)
   - 경고 메시지 (예: "분노 발동!")

예시 - 오크 분노 (힘 +5):
- 메커니즘: 힘(+5) 획득 → 공격력 영구 +5
- UI: 💪5 아이콘 표시
- 연출 (선택):
  - 전신 붉은 오라 효과
  - 공격 애니메이션 강화
  - 경고 메시지: "오크가 분노했다!"

### 연출 구현 원칙

```
✅ 메커니즘 우선
   - 연출은 게임플레이를 방해하지 않음
   - 핵심 정보(데미지, 버프 등)는 UI로 명확히 표시
   - 연출은 부가적 요소

✅ 선택적 구현
   - MVP에서는 최소한의 연출 (UI 중심)
   - Post-MVP에서 단계적 추가
   - 연출 없이도 게임 이해 가능해야 함
---

## 📝 구현 우선순위

### MVP (현재)
```
✅ 슬라임 구현
✅ 고블린 구현
✅ 오크 구현
✅ 행동 패턴 시스템
✅ 예고 시스템
```

### Post-MVP Phase 1 (3개월)
```
🔶 추가 일반 적 3종
🔶 엘리트 시스템
🔶 보스 1종 추가
```

### Post-MVP Phase 2 (6개월)
```
🔶 다중 적 전투
🔶 소환 메커니즘
🔶 추가 보스 2종
```

### Post-MVP Phase 3 (1년)
```
🔶 환경 효과
🔶 난이도 옵션
🔶 Ascension 시스템
```

---

**작성일**: 2025-12-17
**버전**: 1.0
**다음 리뷰**: TBD
**담당**: 게임 디자인
